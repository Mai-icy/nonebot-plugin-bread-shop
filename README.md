# nonebot-plugin-bread-shop

![OSCS Status](https://www.oscs1024.com/platform/badge/Mai-icy/nonebot-plugin-bread-shop.svg?size=small)
[![VERSION](https://img.shields.io/pypi/v/nonebot-plugin-bread-shop)](https://pypi.org/project/nonebot-plugin-bread-shop/)
![GitHub license](https://img.shields.io/badge/python-3.7+-blue.svg)
[![GitHub license](https://img.shields.io/github/license/Mai-icy/nonebot-plugin-bread-shop)](https://github.com/Mai-icy/nonebot-plugin-bread-shop/blob/main/LICENSE)
![Lines of code](https://img.shields.io/tokei/lines/github/Mai-icy/nonebot-plugin-bread-shop)


---


## âš ï¸è­¦å‘Šé¡»çŸ¥ï¼

æœ¬æ’ä»¶ä¸é€‚å®œç”¨äºç¾¤äººå‘˜è¾ƒå¤šçš„ç¾¤ï¼Œç»è¿‡æµ‹è¯•ï¼Œæœ¬åŠŸèƒ½å…·æœ‰æå¤§ä¸Šç˜¾æ€§ï¼Œå®¹æ˜“é€ æˆbotåˆ·å±ï¼Œå½±å“æ­£å¸¸èŠå¤©ï¼

## ğŸ“„ä»‹ç»

é¢åŒ…å°æ¸¸æˆï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡â€œä¹°â€ï¼Œâ€œåƒâ€ï¼Œâ€œæŠ¢â€ï¼Œâ€œé€â€ï¼Œâ€çŒœæ‹³â€œæ“ä½œæ¥è·å–é¢åŒ…å’Œä½¿ç”¨é¢åŒ…ã€‚

å°†ä¼šè®°å½•æ‰€æœ‰ç”¨æˆ·çš„é¢åŒ…æ•°æ®è¿›è¡Œæ’è¡Œ

æ‰€æœ‰çš„æ“ä½œéƒ½å¯èƒ½äº§ç”Ÿç‰¹æ®Šé¢åŒ…äº‹ä»¶å“¦ï¼

ä¸€èµ·æ¥ä¹°é¢åŒ…å§ï¼

> æ³¨ï¼š**é¢åŒ…æ•°æ®åº“ä¸€ä¸ªç¾¤ä¸€ä¸ªï¼Œæ’è¡Œå‡å±äºç¾¤å†…æ’è¡Œï¼Œä¸åŒç¾¤æ‰€æœ‰æ•°æ®ä¸ç›¸å¹²ã€‚**

## ğŸ’¿å®‰è£…
- ä½¿ç”¨ nb-cli

```shell
nb plugin install nonebot-plugin-bread-shop
```

- ä½¿ç”¨ pip

```shell
pip install nonebot-plugin-bread-shop
```

## ğŸ¤”ä½¿ç”¨

| æŒ‡ä»¤ | è¯´æ˜ | å…¶å®ƒå½¢å¼ |
|:-----:|:----:|:----:|
| ä¹°é¢åŒ… | è´­ä¹°éšæœºæ•°é‡é¢åŒ… |buyï¼ŒğŸ|
| å•ƒé¢åŒ… | åƒéšæœºæ•°é‡é¢åŒ… |eatï¼ŒğŸğŸï¼Œåƒé¢åŒ…|
| æŠ¢é¢åŒ… + @æŒ‡å®šç”¨æˆ· | æŠ¢æŒ‡å®šç”¨æˆ·éšæœºæ•°é‡é¢åŒ… |robï¼ŒğŸğŸğŸ|
| é€é¢åŒ… + @æŒ‡å®šç”¨æˆ· | é€æŒ‡å®šç”¨æˆ·éšæœºæ•°é‡é¢åŒ… |giveï¼Œé€|
| æŸ¥çœ‹é¢åŒ… + @æŒ‡å®šç”¨æˆ· | æŸ¥çœ‹æŒ‡å®šç”¨æˆ·çš„é¢åŒ…æ•°æ® |checkï¼Œå·çœ‹é¢åŒ…ï¼ŒæŸ¥çœ‹é¢åŒ…|
| é¢åŒ…è®°å½• + @æŒ‡å®šç”¨æˆ· | æŸ¥çœ‹æŒ‡å®šç”¨æˆ·çš„æ“ä½œæ¬¡æ•° |logbï¼Œè®°å½•|
| é¢åŒ…è®°å½• + â€œä¹°åƒæŠ¢èµ é€çŒœæ‹³â€ | æŸ¥çœ‹æ“ä½œæ¬¡æ•°æœ€å¤šçš„äºº |logbï¼Œè®°å½•|
| èµŒé¢åŒ… + â€œçŸ³å¤´å‰ªåˆ€å¸ƒâ€ | å’Œbotè¿›è¡ŒçŒœæ‹³èµŒéšæœºæ•°é‡é¢åŒ… |betï¼Œé¢åŒ…çŒœæ‹³|
| é¢åŒ…å¸®åŠ© | é€æŒ‡å®šç”¨æˆ·éšæœºæ•°é‡é¢åŒ… |breadhelpï¼Œhelpb|
| é¢åŒ…æ’è¡Œ | å‘é€é¢åŒ…åº—æ“ä½œæŒ‡å— |breadtopï¼Œé¢åŒ…æ’å|

## âš™ï¸è‡ªå®šä¹‰é…ç½®

åœ¨**config.py**çš„æšä¸¾ç±»ä¸­å¯ä»¥è®¾ç½®æ‰€æœ‰éšæœºæ“ä½œçš„æœ€å¤§å€¼å’Œæœ€å°å€¼ä»¥åŠæ“ä½œå†·å´ã€‚

**å‚æ•°è¯´æ˜**ï¼š

**THING**ï¼šå¯ä¿®æ”¹é»˜è®¤çš„â€œé¢åŒ…â€æ”¹ä¸ºå…¶ä»–ç‰©å“ä¾‹å¦‚ï¼š â€œç‚¸é¸¡â€ï¼Œâ€œè›‹ç³•â€ç­‰ç­‰

**LEVEL_NUM**ï¼šä¿®æ”¹å‡çº§ä¸€çº§æ‰€éœ€è¦åƒçš„é¢åŒ…æ•°é‡ï¼Œé»˜è®¤ä¸º10

(æ³¨æ„ï¼šç­‰çº§ä¸è¢«æ•°æ®åº“è®°å½•æ•°æ®åº“åªè®°å½•å·²ç»åƒäº†çš„æ•°é‡ï¼Œä¿®æ”¹è¯¥å€¼ä¼šä½¿ç”¨æˆ·ç­‰çº§å˜åŒ–ï¼Œå˜åŒ–å¯é€†)

**BANNED_GROUPS**ï¼šè®¾ç½®é»‘åå•ç¾¤èŠ

**CD**ï¼šæ“ä½œå†·å´ï¼ˆå•ä½ï¼šç§’ï¼‰

**MAX**ï¼šæ“ä½œéšæœºå€¼ä¸Šé™

**MIN**ï¼šæ“ä½œéšæœºå€¼ä¸‹é™

**random_config**ï¼šå¦‚ä¸‹

```python
def random_config():
    """è®¾ç½®æ“ä½œæ•°é‡æ˜¯å¦ç”±ç”¨æˆ·æŒ‡å®šæˆ–éšæœº"""
    from .bread_operate import BuyEvent, EatEvent, RobEvent, GiveEvent, BetEvent
    # GiveEvent("ç¾¤å·").set_random(False)  # å–æ¶ˆéšæœºï¼ˆå˜ä¸ºç”¨æˆ·æŒ‡å®šï¼Œç”¨æˆ·è‹¥æ²¡æœ‰æŒ‡å®šåˆ™ä¸ºéšæœºï¼‰
    # GiveEvent.set_random_global(False)  # é»˜è®¤å…¨ä¸ºTrue
    # BetEvent.set_random_global(False)  # å…¶å®ƒäº‹ä»¶å‡å¯è®¾ç½®
```

(æ³¨æ„ï¼šæ”¹ä¸ºFalseä¹‹åç”¨æˆ·å¯ä»¥é€šè¿‡ "æ“ä½œå + @ + æ•°é‡" æˆ– "æ“ä½œå + æ•°é‡" è¾¾åˆ°æ•ˆæœ)

## ğŸè‡ªå®šä¹‰äº‹ä»¶

åœ¨**bread_event.py**ä¸­å¯ä»¥ç¼–å†™ç‰¹æ®Šäº‹ä»¶ï¼

ç‰¹æ®Šäº‹ä»¶æ¨¡æ¿ï¼š

group_id_listé»˜è®¤ä¸ºå…¨éƒ¨ç¾¤èŠ

priorityé»˜è®¤ä¸º5ï¼Œæ•°å­—è¶Šä½è¶Šä¼˜å…ˆï¼Œä¼˜å…ˆçº§ç›¸åŒçš„äº‹ä»¶å…ˆåé¡ºåºæ¯æ¬¡éšæœº

```python
@probability(æ¦‚ç‡, Action.æ“ä½œ, priority=ä¼˜å…ˆçº§, group_id_list=["ç¾¤å·1", "ç¾¤å·2"])
def å‡½æ•°å(event: æ“ä½œ):
    # event.user_data å¯ä»¥æŸ¥çœ‹æ“ä½œçš„ç”¨æˆ·çš„é¢åŒ…æ•°æ®
    # event.user_id   å¯ä»¥è·å–æ“ä½œçš„ç”¨æˆ·çš„idï¼ˆqqï¼‰
    # event.user_id   å¯ä»¥è·å–æ“ä½œçš„ç”¨æˆ·çš„idï¼ˆqqï¼‰
    # event.bread_db.reduce_bread(event.user_id, eat_num) å‡å°‘ç”¨æˆ·é¢åŒ…æ•°é‡
    # event.bread_db.reduce_bread(event.user_id, eat_num) å¢åŠ ç”¨æˆ·é¢åŒ…æ•°é‡
    # event.bread_db.add_bread(event.user_id, eat_num, "BREAD_EATEN")  å¢åŠ ç”¨æˆ·é¢åŒ…é£Ÿç”¨é‡
    # event.bread_db.update_no(event.user_id)  æ›´æ–°ç”¨æˆ·æ’å
    # event.bread_db.ban_user_action(event.user_id, Action.EAT, 1800) ç¦æ­¢ç”¨æˆ·æ“ä½œ
    # event.bread_db.cd_refresh(event.user_id, Action.EAT)        åˆ·æ–°ç”¨æˆ·CD
    # event.bread_db.update_cd_stamp(event.user_id, Action.GIVE)  é‡ç½®ç”¨æˆ·CD
    # ç­‰ç­‰è§æºç 
    return append_text  # è¿”å›å›ç­”ï¼Œç”±botå‘é€
```

ç‰¹æ®Šäº‹ä»¶ç¤ºä¾‹ï¼š

```python
@probability(0.1, Action.EAT, priority=5)
def eat_event_much(event: EatEvent):
    if event.user_data.bread_num <= MAX.EAT.value:
        return
    eat_num = random.randint(MAX.EAT.value, min(MAX.EAT.value * 2, event.user_data.bread_num))
    event.bread_db.reduce_bread(event.user_id, eat_num)
    event.bread_db.add_bread(event.user_id, eat_num, "BREAD_EATEN")
    append_text = f"æˆåŠŸåƒæ‰äº†{eat_num}ä¸ªé¢åŒ…wï¼åƒå¤ªå¤šå•¦ï¼Œæ’‘æ­»äº†ï¼Œä¸‹æ¬¡åƒå¤šç­‰30åˆ†é’Ÿï¼"
    event.bread_db.update_no(event.user_id)
    event.bread_db.ban_user_action(event.user_id, Action.EAT, 1800)
    return append_text
```

è‹¥æƒ³è¦è®¾ç½®ä¹°é¢åŒ…æ‰“çƒŠæ—¶é—´å¦‚ï¼š

```python
@probability(1, Action.EAT, priority=1, group_id_list=["ç¾¤å·1", "ç¾¤å·2"])
def closing_time(event: EatEvent):
    if åˆ¤æ–­æ—¶é—´:
        event.bread_db.reduce_user_log(event.user_id, Action.EAT)  # é˜²æ­¢è®°å½•
    	return "æ‰“çƒŠ"
```

å…¶ä»–æ³¨æ„ç‚¹ï¼š

event.normal_event()ä¸ºäº‹ä»¶æ­£å¸¸è¿›è¡Œå…¨æµç¨‹å¹¶è¿”å›åŸæ¥çš„è¯ã€‚

ä¾‹å¦‚ï¼š

```python
@probability(0.1, Action.BET, priority=5)
def bet_event_addiction(event: BetEvent):
    append_text = event.normal_event()
    append_text += " æœ‰ç‚¹ä¸Šç˜¾ï¼Œä½ æƒ³å†æ¥ä¸€æŠŠï¼"
    event.bread_db.cd_refresh(event.user_id, Action.BET)
    return append_text
```



return None ç›¸å½“äºäº‹ä»¶ä¸è§¦å‘ï¼Œè¿”å›ä»»ä½•å­—ç¬¦ä¸²éƒ½è®¤å®šä¸ºäº‹ä»¶è§¦å‘

